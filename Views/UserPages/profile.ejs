<% layout("layouts/boilerplate") %>

<div class="min-h-[100dvh] flex flex-col items-center  p-4">
 <div class="p-6 w-full max-w-5xl">
  <div class="flex items-center justify-between">
    <!-- Profile Picture -->
    <div class="flex items-center">
      <div class="rounded-full bg-gray-700 p-4">
        <img src="/imgs/profile_pic.png" alt="Profile" class="w-20 h-20 rounded-full">
      </div>
      <div class="ml-4">
        <h1 class="text-3xl font-bold"><%= user.username.toUpperCase() %></h1>
        <p class="text-gray-400">Date Joined: <%= user.joinedDate.toLocaleDateString() %> </p>
        <% if (activeChallenge) { %>
          <p class="text-gray-400">Current Challenge: <%= activeChallenge.name %></p>
          <% } %>
      </div>
    </div>
  </div>

  <!-- Challenges Section -->
  <div class="mt-8">
    <h2 class="text-xl font-semibold">Challenges</h2>
    <hr class="my-4 border-gray-500">
    
    <!-- Challenge Cards -->
    <div class="flex flex-wrap">
      <% for( let challenge of challenges ) { %>
      <a href="/user/<%= user.username %>/challenges/<%= challenge._id %>" class="glassmorph hover:glassmorph p-4 rounded-lg w-1/3 m-2 shadow-md flex flex-col justify-around">
        <h3 class="text-lg font-semibold"><%= challenge.name %></h3>
        <p class="mt-2 text-gray-400">
          <%= challenge.description %>
        </p>
        <p class="mt-4 <%= challenge.status === 'active' ? 'text-green-400' : 'text-red-600' %>  font-bold">Status: <%= challenge.status  %></p>
      </a>
      <% } %>

      <!-- Add more challenge cards as needed -->
      <% if (owner === true) { %>
        <a href="/user/<%= user.username %>/challenges/new" class="glassmorph hover:glassmorph p-4 rounded-lg w-1/3 m-2 shadow-md text-center flex flex-col justify-center items-center" >
            <img src="/imgs/add-icon.png" alt="Add" class="mx-auto w-20 h-20 align-middle" />
            <h3 class="text-base font-medium text-center">New Challenge</h3>
        </a>
      <% } %>
  </div>
  <% if (owner) { %>
    <div class="mt-10">
    <button class="text-lg shadow-lg bg-red-800 w-44 px-3 py-2 rounded-xl hover:shadow-red-600/40 duration-200"><a href="/user/logout">Log Out</a></button>
  </div>
  <% } %>
</div>
</div>